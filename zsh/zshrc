### ZSH SETTINGS ###
### If not running interactively, don't do anything
[[ $- != *i* ]] && return

# Other source files
source $ZDOTDIR/zsh-settings
source $ZDOTDIR/zsh-aliases
source $ZDOTDIR/.iterm2_shell_integration.zsh


### PLUGINS using Zinit ###
# Commands:
#       zinit self-update
#       zinit update

ZINIT_HOME="${ZDOTDIR}/.zinit"
if [[ ! -f $ZINIT_HOME/zinit.zsh ]]; then
    print -P "%F{33}▓▒░ %F{220}Installing %F{33}DHARMA%F{220} Initiative Plugin Manager (%F{33}zdharma/zinit%F{220})…%f"
    command mkdir -p "$ZINIT_HOME" && command chmod g-rwX "$ZINIT_HOME"
    command git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME" && \
        print -P "%F{33}▓▒░ %F{34}Installation successful.%f%b" || \
        print -P "%F{160}▓▒░ The clone has failed.%f%b"
fi

source "${ZINIT_HOME}/zinit.zsh"
autoload -Uz _zinit
(( ${+_comps} )) && _comps[zinit]=_zinit
### End of Zinit installer's chunk

### User plugins
# Load a few important annexes, without turbo 
zinit light-mode for \
    zdharma-continuum/zinit-annex-patch-dl \
    zdharma-continuum/zinit-annex-submods \
    zdharma-continuum/zinit-annex-man

zinit ice silent wait atload:_zsh_autosuggest_start
zinit light zsh-users/zsh-autosuggestions

zinit ice blockf
zinit light zsh-users/zsh-completions
zinit light greymd/docker-zsh-completion
zinit light agkozak/zsh-z

zinit ice silent wait!1 atload"ZINIT[COMPINIT_OPTS]=-C; zpcompinit"
zinit light zdharma-continuum/fast-syntax-highlighting
zinit light Aloxaf/fzf-tab


##### PROGRAMMING #####
# Rust, Go

### Haskell - Ghcup
[ -f "/Users/sung/.ghcup/env" ] && source "/Users/sung/.ghcup/env" # ghcup-env

### Python - Conda
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$('/opt/homebrew/Caskroom/miniconda/base/bin/conda' 'shell.zsh' 'hook' 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__conda_setup"
else
    if [ -f "/opt/homebrew/Caskroom/miniconda/base/etc/profile.d/conda.sh" ]; then
        . "/opt/homebrew/Caskroom/miniconda/base/etc/profile.d/conda.sh"
    else
        export PATH="/opt/homebrew/Caskroom/miniconda/base/bin:$PATH"
    fi
fi
unset __conda_setup
# conda config --set auto_activate_base False
# conda config --set changeps1 False

### Javascript - NVM
export NVM_DIR="$HOME/.nvm"
[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && . "/opt/homebrew/opt/nvm/nvm.sh"  
[ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && . "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  



### PATH variable
path=("/opt/homebrew/bin" "/Users/sung/.local/bin" "/Users/sung/.cargo/bin" "/Applications/Firefox.app/Contents/MacOS" "$path[@]")
typeset -U PATH path
export PATH

### Starship prompt
eval "$(starship init zsh)"

echo -ne '\e[3 q'
